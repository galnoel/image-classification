2026-01-22 07:28:57,203 - INFO - Configuration loaded and logging set up.
2026-01-22 07:28:57,203 - INFO - All outputs for this run will be saved in: outputs\coat_lite_mini_20260122_072857
2026-01-22 07:28:58,804 - INFO - Using device: cuda
2026-01-22 07:28:58,804 - INFO - Starting data preparation...
2026-01-22 07:28:58,820 - INFO - Using training data from: data/histopathologic-oral-cancer/train
2026-01-22 07:28:58,820 - INFO - Using validation data from: data/histopathologic-oral-cancer/test
2026-01-22 07:28:58,820 - INFO - Data preparation complete. Found classes: ['Normal', 'OSCC']
2026-01-22 07:28:58,820 - INFO - Initializing model: coat_lite_mini
2026-01-22 07:28:59,057 - INFO - Model 'coat_lite_mini' initialized and moved to 'cuda'.
2026-01-22 07:28:59,057 - INFO - Using CrossEntropyLoss.
2026-01-22 07:28:59,057 - INFO - Using AdamW optimizer with learning rate: 0.001
2026-01-22 07:28:59,057 - INFO - Loss function and optimizer initialized.
2026-01-22 07:28:59,057 - INFO - --- Starting Stage 1: Feature Extraction ---
2026-01-22 07:28:59,057 - INFO - Starting training for 5 epochs...
2026-01-22 07:30:44,924 - INFO - Epoch: 01 | Train Loss: 0.4974 | Train Acc: 0.7611 | Train F1: 0.7610 | Test Loss: 0.4312 | Test Acc: 0.7604 | Test F1: 0.7455
2026-01-22 07:30:44,924 - INFO - Validation loss decreased (inf --> 0.431201).  Saving model ...
2026-01-22 07:32:12,292 - INFO - Epoch: 02 | Train Loss: 0.4089 | Train Acc: 0.8215 | Train F1: 0.8215 | Test Loss: 0.4176 | Test Acc: 0.7969 | Test F1: 0.7721
2026-01-22 07:32:12,292 - INFO - Validation loss decreased (0.431201 --> 0.417566).  Saving model ...
2026-01-22 07:33:39,237 - INFO - Epoch: 03 | Train Loss: 0.3768 | Train Acc: 0.8392 | Train F1: 0.8393 | Test Loss: 0.4109 | Test Acc: 0.7943 | Test F1: 0.7874
2026-01-22 07:33:39,237 - INFO - Validation loss decreased (0.417566 --> 0.410884).  Saving model ...
2026-01-22 07:35:06,665 - INFO - Epoch: 04 | Train Loss: 0.3589 | Train Acc: 0.8451 | Train F1: 0.8453 | Test Loss: 0.4081 | Test Acc: 0.7943 | Test F1: 0.7929
2026-01-22 07:35:06,665 - INFO - Validation loss decreased (0.410884 --> 0.408133).  Saving model ...
2026-01-22 07:36:34,802 - INFO - Epoch: 05 | Train Loss: 0.3447 | Train Acc: 0.8537 | Train F1: 0.8536 | Test Loss: 0.3967 | Test Acc: 0.7995 | Test F1: 0.7766
2026-01-22 07:36:34,802 - INFO - Validation loss decreased (0.408133 --> 0.396711).  Saving model ...
2026-01-22 07:36:34,865 - INFO - Training process finished.
2026-01-22 07:36:34,865 - INFO - Generating final confusion matrix on the test set with the best model...
2026-01-22 07:37:06,083 - INFO - Confusion matrix saved to outputs\coat_lite_mini_20260122_072857/confusion_matrix.png
2026-01-22 07:37:06,083 - INFO - Stage 1 (Feature Extraction) complete.
2026-01-22 07:37:06,083 - INFO - Report saved to outputs\coat_lite_mini_20260122_072857\results_report.pkl
2026-01-22 07:37:06,369 - INFO - Training curves plot saved to: outputs\coat_lite_mini_20260122_072857/training_curves.png
2026-01-22 07:37:06,369 - INFO - --- Starting Stage 2: Fine-Tuning ---
2026-01-22 07:37:06,422 - INFO - Loaded best model from Stage 1: outputs\coat_lite_mini_20260122_072857/best_model.pth
2026-01-22 07:37:06,422 - INFO - Fine-tuning coat_lite_mini: Unfroze all layers except patch embeddings.
2026-01-22 07:37:06,422 - INFO - Created new AdamW optimizer for fine-tuning with learning rate: 5e-05
2026-01-22 07:37:06,422 - INFO - Starting training for 10 epochs...
2026-01-22 07:39:07,236 - INFO - Epoch: 01 | Train Loss: 0.2348 | Train Acc: 0.9037 | Train F1: 0.9036 | Test Loss: 0.2431 | Test Acc: 0.9115 | Test F1: 0.9035
2026-01-22 07:39:07,236 - INFO - Validation loss decreased (inf --> 0.243090).  Saving model ...
2026-01-22 07:41:07,331 - INFO - Epoch: 02 | Train Loss: 0.1038 | Train Acc: 0.9616 | Train F1: 0.9618 | Test Loss: 0.2905 | Test Acc: 0.9245 | Test F1: 0.9235
2026-01-22 07:41:07,331 - INFO - EarlyStopping counter: 1 out of 3
2026-01-22 07:43:06,910 - INFO - Epoch: 03 | Train Loss: 0.0555 | Train Acc: 0.9802 | Train F1: 0.9802 | Test Loss: 0.3203 | Test Acc: 0.9271 | Test F1: 0.9235
2026-01-22 07:43:06,910 - INFO - EarlyStopping counter: 2 out of 3
2026-01-22 07:45:06,460 - INFO - Epoch: 04 | Train Loss: 0.0368 | Train Acc: 0.9879 | Train F1: 0.9879 | Test Loss: 0.2768 | Test Acc: 0.9193 | Test F1: 0.9156
2026-01-22 07:45:06,460 - INFO - EarlyStopping counter: 3 out of 3
2026-01-22 07:45:06,460 - INFO - Early stopping triggered. Stopping training.
2026-01-22 07:45:06,463 - INFO - Training process finished.
2026-01-22 07:45:06,463 - INFO - Generating final confusion matrix on the test set with the best model...
2026-01-22 07:45:37,111 - INFO - Confusion matrix saved to outputs\coat_lite_mini_20260122_072857/confusion_matrix_finetuned.png
2026-01-22 07:45:37,111 - INFO - Stage 2 (Fine-Tuning) complete.
2026-01-22 07:45:37,112 - INFO - Report saved to outputs\coat_lite_mini_20260122_072857\results_report_finetuned.pkl
2026-01-22 07:45:37,257 - INFO - Training curves plot saved to: outputs\coat_lite_mini_20260122_072857/training_curves_finetuned.png
2026-01-22 07:45:37,257 - INFO - All artifacts for the run are saved in: outputs\coat_lite_mini_20260122_072857
2026-01-22 07:45:37,257 - INFO - ==================================================
2026-01-22 07:45:37,257 - INFO - PIPELINE EXECUTION COMPLETE
2026-01-22 07:45:37,257 - INFO - Total duration: 16 minutes and 40 seconds.
2026-01-22 07:45:37,257 - INFO - ==================================================
