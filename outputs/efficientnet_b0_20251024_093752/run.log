2025-10-24 09:37:52,555 - INFO - Configuration loaded and logging set up.
2025-10-24 09:37:52,556 - INFO - All outputs for this run will be saved in: outputs\efficientnet_b0_20251024_093752
2025-10-24 09:37:52,600 - INFO - Using device: cuda
2025-10-24 09:37:52,601 - INFO - Starting data preparation...
2025-10-24 09:37:52,602 - INFO - No pre-existing split data or incomplete. Starting data preparation...
2025-10-24 09:37:52,603 - INFO - Collecting files from source directories: ['data/PetImages/Cat', 'data/PetImages/Dog']
2025-10-24 09:37:52,603 - INFO - Found class: Cat in 'data\PetImages\Cat'
2025-10-24 09:37:52,622 - INFO - Found class: Dog in 'data\PetImages\Dog'
2025-10-24 09:37:52,642 - INFO - Splitting combined data (test ratio: 0.2) and copying files...
2025-10-24 09:40:23,987 - INFO - Data splitting complete. Processed data saved to: data_processed
2025-10-24 09:40:23,988 - INFO - Creating PyTorch DataLoaders...
2025-10-24 09:40:24,046 - INFO - Classes identified: ['Cat', 'Dog']
2025-10-24 09:40:24,052 - INFO - Using training data from: data_processed/train
2025-10-24 09:40:24,053 - INFO - Using validation data from: data_processed/test
2025-10-24 09:40:24,053 - INFO - Data preparation complete. Found classes: ['Cat', 'Dog']
2025-10-24 09:40:24,053 - INFO - Initializing model: efficientnet_b0
2025-10-24 09:40:24,292 - INFO - Model 'efficientnet_b0' initialized and moved to 'cuda'.
2025-10-24 09:40:24,293 - INFO - Using AdamW optimizer with learning rate: 0.001
2025-10-24 09:40:24,293 - INFO - Loss function and optimizer initialized.
2025-10-24 09:40:24,293 - INFO - --- Starting Stage 1: Feature Extraction ---
2025-10-24 09:40:24,293 - INFO - Starting training for 5 epochs...
2025-10-24 09:42:29,653 - INFO - Epoch: 01 | Train Loss: 0.2691 | Train Acc: 0.8831 | Test Loss: 0.0812 | Test Acc: 0.9721
2025-10-24 09:42:29,690 - INFO - Model saved to outputs\efficientnet_b0_20251024_093752\best_model.pth
2025-10-24 09:42:29,691 - INFO - New best model saved to outputs\efficientnet_b0_20251024_093752/best_model.pth (Test Acc: 0.9721)
2025-10-24 09:43:29,032 - INFO - Epoch: 02 | Train Loss: 0.2368 | Train Acc: 0.8938 | Test Loss: 0.0683 | Test Acc: 0.9741
2025-10-24 09:43:29,072 - INFO - Model saved to outputs\efficientnet_b0_20251024_093752\best_model.pth
2025-10-24 09:43:29,073 - INFO - New best model saved to outputs\efficientnet_b0_20251024_093752/best_model.pth (Test Acc: 0.9741)
2025-10-24 09:44:32,794 - INFO - Epoch: 03 | Train Loss: 0.2332 | Train Acc: 0.8962 | Test Loss: 0.0647 | Test Acc: 0.9763
2025-10-24 09:44:32,891 - INFO - Model saved to outputs\efficientnet_b0_20251024_093752\best_model.pth
2025-10-24 09:44:32,892 - INFO - New best model saved to outputs\efficientnet_b0_20251024_093752/best_model.pth (Test Acc: 0.9763)
2025-10-24 09:45:53,514 - INFO - Epoch: 04 | Train Loss: 0.2290 | Train Acc: 0.8987 | Test Loss: 0.0658 | Test Acc: 0.9763
2025-10-24 09:46:53,834 - INFO - Epoch: 05 | Train Loss: 0.2312 | Train Acc: 0.8961 | Test Loss: 0.0602 | Test Acc: 0.9811
2025-10-24 09:46:53,875 - INFO - Model saved to outputs\efficientnet_b0_20251024_093752\best_model.pth
2025-10-24 09:46:53,876 - INFO - New best model saved to outputs\efficientnet_b0_20251024_093752/best_model.pth (Test Acc: 0.9811)
2025-10-24 09:46:53,877 - INFO - Training process finished.
2025-10-24 09:46:53,877 - INFO - Generating final confusion matrix on the test set with the best model...
2025-10-24 09:47:16,239 - INFO - Confusion matrix saved to outputs\efficientnet_b0_20251024_093752/confusion_matrix.png
2025-10-24 09:47:16,239 - INFO - Stage 1 (Feature Extraction) complete.
2025-10-24 09:47:16,241 - INFO - Report saved to outputs\efficientnet_b0_20251024_093752\results_report.pkl
2025-10-24 09:47:16,474 - INFO - Training curves plot saved to: outputs\efficientnet_b0_20251024_093752/training_curves.png
2025-10-24 09:47:16,475 - INFO - --- Starting Stage 2: Fine-Tuning ---
2025-10-24 09:47:16,542 - INFO - Loaded best model from Stage 1: outputs\efficientnet_b0_20251024_093752/best_model.pth
2025-10-24 09:47:16,542 - INFO - Unfroze the top layers of the model for fine-tuning.
2025-10-24 09:47:16,543 - INFO - Created new AdamW optimizer for fine-tuning with learning rate: 0.0001
2025-10-24 09:47:16,544 - INFO - Starting training for 3 epochs...
2025-10-24 09:48:18,951 - INFO - Epoch: 01 | Train Loss: 0.1792 | Train Acc: 0.9208 | Test Loss: 0.0264 | Test Acc: 0.9900
2025-10-24 09:48:18,990 - INFO - Model saved to outputs\efficientnet_b0_20251024_093752\best_model_finetuned.pth
2025-10-24 09:48:18,991 - INFO - New best model saved to outputs\efficientnet_b0_20251024_093752/best_model_finetuned.pth (Test Acc: 0.9900)
2025-10-24 09:49:40,777 - INFO - Epoch: 02 | Train Loss: 0.1464 | Train Acc: 0.9336 | Test Loss: 0.0223 | Test Acc: 0.9910
2025-10-24 09:49:40,868 - INFO - Model saved to outputs\efficientnet_b0_20251024_093752\best_model_finetuned.pth
2025-10-24 09:49:40,870 - INFO - New best model saved to outputs\efficientnet_b0_20251024_093752/best_model_finetuned.pth (Test Acc: 0.9910)
2025-10-24 09:50:54,093 - INFO - Epoch: 03 | Train Loss: 0.1241 | Train Acc: 0.9476 | Test Loss: 0.0208 | Test Acc: 0.9916
2025-10-24 09:50:54,134 - INFO - Model saved to outputs\efficientnet_b0_20251024_093752\best_model_finetuned.pth
2025-10-24 09:50:54,134 - INFO - New best model saved to outputs\efficientnet_b0_20251024_093752/best_model_finetuned.pth (Test Acc: 0.9916)
2025-10-24 09:50:54,135 - INFO - Training process finished.
2025-10-24 09:50:54,135 - INFO - Generating final confusion matrix on the test set with the best model...
2025-10-24 09:51:16,471 - INFO - Confusion matrix saved to outputs\efficientnet_b0_20251024_093752/confusion_matrix_finetuned.png
2025-10-24 09:51:16,472 - INFO - Stage 2 (Fine-Tuning) complete.
2025-10-24 09:51:16,473 - INFO - Report saved to outputs\efficientnet_b0_20251024_093752\results_report_finetuned.pkl
2025-10-24 09:51:16,643 - INFO - Training curves plot saved to: outputs\efficientnet_b0_20251024_093752/training_curves_finetuned.png
2025-10-24 09:51:16,643 - INFO - All artifacts for the run are saved in: outputs\efficientnet_b0_20251024_093752
