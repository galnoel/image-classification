2025-10-24 23:40:26,955 - INFO - Configuration loaded and logging set up.
2025-10-24 23:40:26,956 - INFO - All outputs for this run will be saved in: outputs\resnet50_20251024_234026
2025-10-24 23:40:26,976 - INFO - Using device: cuda
2025-10-24 23:40:26,976 - INFO - Starting data preparation...
2025-10-24 23:40:27,010 - INFO - Pre-existing split data found. Skipping data splitting.
2025-10-24 23:40:27,011 - INFO - Creating PyTorch DataLoaders...
2025-10-24 23:40:27,066 - INFO - Classes identified: ['Cat', 'Dog']
2025-10-24 23:40:27,067 - INFO - Using training data from: data_processed/train
2025-10-24 23:40:27,067 - INFO - Using validation data from: data_processed/test
2025-10-24 23:40:27,067 - INFO - Data preparation complete. Found classes: ['Cat', 'Dog']
2025-10-24 23:40:27,070 - INFO - Initializing model: resnet50
2025-10-24 23:40:27,412 - INFO - Model 'resnet50' initialized and moved to 'cuda'.
2025-10-24 23:40:27,412 - INFO - Using AdamW optimizer with learning rate: 0.001
2025-10-24 23:40:27,412 - INFO - Loss function and optimizer initialized.
2025-10-24 23:40:27,413 - INFO - --- Starting Stage 1: Feature Extraction ---
2025-10-24 23:40:27,413 - INFO - Starting training for 5 epochs...
2025-10-24 23:41:48,910 - INFO - Epoch: 01 | Train Loss: 0.1930 | Train Acc: 0.9234 | Test Loss: 0.0270 | Test Acc: 0.9918
2025-10-24 23:41:49,018 - INFO - Model saved to outputs\resnet50_20251024_234026\best_model.pth
2025-10-24 23:41:49,019 - INFO - New best model saved to outputs\resnet50_20251024_234026/best_model.pth (Test Acc: 0.9918)
2025-10-24 23:43:11,757 - INFO - Epoch: 02 | Train Loss: 0.1477 | Train Acc: 0.9347 | Test Loss: 0.0232 | Test Acc: 0.9924
2025-10-24 23:43:11,859 - INFO - Model saved to outputs\resnet50_20251024_234026\best_model.pth
2025-10-24 23:43:11,859 - INFO - New best model saved to outputs\resnet50_20251024_234026/best_model.pth (Test Acc: 0.9924)
2025-10-24 23:44:35,167 - INFO - Epoch: 03 | Train Loss: 0.1437 | Train Acc: 0.9338 | Test Loss: 0.0209 | Test Acc: 0.9930
2025-10-24 23:44:35,292 - INFO - Model saved to outputs\resnet50_20251024_234026\best_model.pth
2025-10-24 23:44:35,292 - INFO - New best model saved to outputs\resnet50_20251024_234026/best_model.pth (Test Acc: 0.9930)
2025-10-24 23:45:59,515 - INFO - Epoch: 04 | Train Loss: 0.1342 | Train Acc: 0.9419 | Test Loss: 0.0201 | Test Acc: 0.9926
2025-10-24 23:47:23,728 - INFO - Epoch: 05 | Train Loss: 0.1381 | Train Acc: 0.9391 | Test Loss: 0.0186 | Test Acc: 0.9936
2025-10-24 23:47:23,838 - INFO - Model saved to outputs\resnet50_20251024_234026\best_model.pth
2025-10-24 23:47:23,838 - INFO - New best model saved to outputs\resnet50_20251024_234026/best_model.pth (Test Acc: 0.9936)
2025-10-24 23:47:23,839 - INFO - Training process finished.
2025-10-24 23:47:23,839 - INFO - Generating final confusion matrix on the test set with the best model...
2025-10-24 23:47:54,150 - INFO - Confusion matrix saved to outputs\resnet50_20251024_234026/confusion_matrix.png
2025-10-24 23:47:54,151 - INFO - Stage 1 (Feature Extraction) complete.
2025-10-24 23:47:54,153 - INFO - Report saved to outputs\resnet50_20251024_234026\results_report.pkl
2025-10-24 23:47:54,317 - INFO - Training curves plot saved to: outputs\resnet50_20251024_234026/training_curves.png
2025-10-24 23:47:54,318 - INFO - --- Starting Stage 2: Fine-Tuning ---
2025-10-24 23:47:54,400 - INFO - Loaded best model from Stage 1: outputs\resnet50_20251024_234026/best_model.pth
2025-10-24 23:47:54,400 - INFO - Unfroze layer4 of ResNet for fine-tuning.
2025-10-24 23:47:54,400 - INFO - Created new AdamW optimizer for fine-tuning with learning rate: 0.0001
2025-10-24 23:47:54,401 - INFO - Starting training for 3 epochs...
2025-10-24 23:49:26,875 - INFO - Epoch: 01 | Train Loss: 0.1180 | Train Acc: 0.9477 | Test Loss: 0.0144 | Test Acc: 0.9942
2025-10-24 23:49:26,968 - INFO - Model saved to outputs\resnet50_20251024_234026\best_model_finetuned.pth
2025-10-24 23:49:26,969 - INFO - New best model saved to outputs\resnet50_20251024_234026/best_model_finetuned.pth (Test Acc: 0.9942)
2025-10-24 23:50:59,448 - INFO - Epoch: 02 | Train Loss: 0.0959 | Train Acc: 0.9609 | Test Loss: 0.0128 | Test Acc: 0.9948
2025-10-24 23:50:59,673 - INFO - Model saved to outputs\resnet50_20251024_234026\best_model_finetuned.pth
2025-10-24 23:50:59,673 - INFO - New best model saved to outputs\resnet50_20251024_234026/best_model_finetuned.pth (Test Acc: 0.9948)
2025-10-24 23:52:31,594 - INFO - Epoch: 03 | Train Loss: 0.0886 | Train Acc: 0.9614 | Test Loss: 0.0117 | Test Acc: 0.9946
2025-10-24 23:52:31,595 - INFO - Training process finished.
2025-10-24 23:52:31,595 - INFO - Generating final confusion matrix on the test set with the best model...
2025-10-24 23:53:01,575 - INFO - Confusion matrix saved to outputs\resnet50_20251024_234026/confusion_matrix_finetuned.png
2025-10-24 23:53:01,576 - INFO - Stage 2 (Fine-Tuning) complete.
2025-10-24 23:53:01,577 - INFO - Report saved to outputs\resnet50_20251024_234026\results_report_finetuned.pkl
2025-10-24 23:53:01,735 - INFO - Training curves plot saved to: outputs\resnet50_20251024_234026/training_curves_finetuned.png
2025-10-24 23:53:01,735 - INFO - All artifacts for the run are saved in: outputs\resnet50_20251024_234026
2025-10-24 23:53:01,735 - INFO - ==================================================
2025-10-24 23:53:01,736 - INFO - PIPELINE EXECUTION COMPLETE
2025-10-24 23:53:01,736 - INFO - Total duration: 12 minutes and 34 seconds.
2025-10-24 23:53:01,736 - INFO - ==================================================
