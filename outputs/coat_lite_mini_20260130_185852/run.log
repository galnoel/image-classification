2026-01-30 18:58:52,032 - INFO - Configuration loaded and logging set up.
2026-01-30 18:58:52,032 - INFO - All outputs for this run will be saved in: outputs\coat_lite_mini_20260130_185852
2026-01-30 18:58:53,797 - INFO - Using device: cuda
2026-01-30 18:58:53,797 - INFO - Starting data preparation...
2026-01-30 18:58:54,705 - INFO - Using training data from: data/histopathologic-oral-cancer/train
2026-01-30 18:58:54,705 - INFO - Using validation data from: data/histopathologic-oral-cancer/val
2026-01-30 18:58:54,705 - INFO - Data preparation complete. Found classes: ['Normal', 'OSCC']
2026-01-30 18:58:54,705 - INFO - Initializing model: coat_lite_mini
2026-01-30 18:58:56,129 - INFO - Model 'coat_lite_mini' initialized and moved to 'cuda'.
2026-01-30 18:58:56,129 - INFO - Using Kornia FocalLoss with params: {'alpha': 0.25, 'gamma': 2.0, 'reduction': 'mean'}
2026-01-30 18:58:56,145 - INFO - Using AdamW optimizer with learning rate: 0.001
2026-01-30 18:58:56,145 - INFO - Loss function and optimizer initialized.
2026-01-30 18:58:56,145 - INFO - --- Starting Stage 1: Feature Extraction ---
2026-01-30 18:58:56,145 - INFO - Starting training for 5 epochs...
2026-01-30 19:13:45,062 - INFO - Configuration loaded and logging set up.
2026-01-30 19:13:45,063 - INFO - All outputs for this run will be saved in: outputs\coat_lite_mini_20260130_191345
2026-01-30 19:13:45,063 - INFO - Using device: cuda
2026-01-30 19:13:45,065 - INFO - Starting data preparation...
2026-01-30 19:13:45,089 - INFO - Using training data from: data/histopathologic-oral-cancer/train
2026-01-30 19:13:45,089 - INFO - Using validation data from: data/histopathologic-oral-cancer/val
2026-01-30 19:13:45,093 - INFO - Data preparation complete. Found classes: ['Normal', 'OSCC']
2026-01-30 19:13:45,094 - INFO - Initializing model: coat_lite_mini
2026-01-30 19:13:45,262 - INFO - Model 'coat_lite_mini' initialized and moved to 'cuda'.
2026-01-30 19:13:45,262 - INFO - Using Kornia FocalLoss with params: {'alpha': 0.25, 'gamma': 2.0, 'reduction': 'mean'}
2026-01-30 19:13:45,266 - INFO - Using AdamW optimizer with learning rate: 0.001
2026-01-30 19:13:45,266 - INFO - Loss function and optimizer initialized.
2026-01-30 19:13:45,268 - INFO - --- Starting Stage 1: Feature Extraction ---
2026-01-30 19:13:45,269 - INFO - Starting training for 5 epochs...
2026-01-30 19:35:18,125 - INFO - Configuration loaded and logging set up.
2026-01-30 19:35:18,126 - INFO - All outputs for this run will be saved in: outputs\coat_lite_mini_20260130_193518
2026-01-30 19:35:18,126 - INFO - Using device: cuda
2026-01-30 19:35:18,127 - INFO - Starting data preparation...
2026-01-30 19:35:18,505 - INFO - Using training data from: data/histopathologic-oral-cancer/train
2026-01-30 19:35:18,505 - INFO - Using validation data from: data/histopathologic-oral-cancer/val
2026-01-30 19:35:18,505 - INFO - Data preparation complete. Found classes: ['Normal', 'OSCC']
2026-01-30 19:35:18,510 - INFO - Initializing model: coat_lite_mini
2026-01-30 19:35:18,771 - INFO - Model 'coat_lite_mini' initialized and moved to 'cuda'.
2026-01-30 19:35:18,772 - INFO - Using Kornia FocalLoss with params: {'alpha': 0.25, 'gamma': 2.0, 'reduction': 'mean'}
2026-01-30 19:35:18,774 - INFO - Using AdamW optimizer with learning rate: 0.001
2026-01-30 19:35:18,775 - INFO - Loss function and optimizer initialized.
2026-01-30 19:35:18,776 - INFO - --- Starting Stage 1: Feature Extraction ---
2026-01-30 19:35:18,777 - INFO - Starting training for 5 epochs...
2026-01-30 19:37:08,026 - INFO - Epoch: 01 | Train Loss: 0.0266 | Train F1: 0.6999 | Train Acc: 0.7132 | Test Loss: 0.0267 | Test F1: 0.6518 | Test Acc: 0.6562
2026-01-30 19:37:08,028 - INFO - Validation loss decreased (inf --> 0.026696).  Saving model ...
2026-01-30 19:38:48,602 - INFO - Epoch: 02 | Train Loss: 0.0214 | Train F1: 0.7813 | Train Acc: 0.7864 | Test Loss: 0.0236 | Test F1: 0.6771 | Test Acc: 0.7031
2026-01-30 19:38:48,602 - INFO - Validation loss decreased (0.026696 --> 0.023647).  Saving model ...
2026-01-30 19:40:38,256 - INFO - Epoch: 03 | Train Loss: 0.0197 | Train F1: 0.8003 | Train Acc: 0.8040 | Test Loss: 0.0226 | Test F1: 0.7024 | Test Acc: 0.7396
2026-01-30 19:40:38,256 - INFO - Validation loss decreased (0.023647 --> 0.022588).  Saving model ...
2026-01-30 19:42:14,715 - INFO - Epoch: 04 | Train Loss: 0.0195 | Train F1: 0.8097 | Train Acc: 0.8125 | Test Loss: 0.0210 | Test F1: 0.7111 | Test Acc: 0.7839
2026-01-30 19:42:14,715 - INFO - Validation loss decreased (0.022588 --> 0.020999).  Saving model ...
2026-01-30 19:43:58,413 - INFO - Epoch: 05 | Train Loss: 0.0187 | Train F1: 0.8197 | Train Acc: 0.8220 | Test Loss: 0.0204 | Test F1: 0.7069 | Test Acc: 0.7422
2026-01-30 19:43:58,413 - INFO - EarlyStopping counter: 1 out of 3
2026-01-30 19:43:58,413 - INFO - Training process finished.
2026-01-30 19:43:58,420 - INFO - Generating final confusion matrix on the test set with the best model...
2026-01-30 19:44:08,392 - INFO - Confusion matrix saved to outputs\coat_lite_mini_20260130_185852/confusion_matrix.png
2026-01-30 19:44:08,393 - INFO - Stage 1 (Feature Extraction) complete.
2026-01-30 19:44:08,395 - INFO - Report saved to outputs\coat_lite_mini_20260130_185852\results_report.pkl
2026-01-30 19:44:08,614 - INFO - Training curves plot saved to: outputs\coat_lite_mini_20260130_185852/training_curves.png
2026-01-30 19:44:08,614 - INFO - --- Starting Stage 2: Fine-Tuning ---
2026-01-30 19:44:08,670 - INFO - Loaded best model from Stage 1: outputs\coat_lite_mini_20260130_185852/best_model.pth
2026-01-30 19:44:08,670 - INFO - Fine-tuning coat_lite_mini: Unfroze all layers except patch embeddings.
2026-01-30 19:44:08,670 - INFO - Created new AdamW optimizer for fine-tuning with learning rate: 5e-05
2026-01-30 19:44:08,670 - INFO - Starting training for 10 epochs...
2026-01-30 19:46:36,663 - INFO - Epoch: 01 | Train Loss: 0.0139 | Train F1: 0.8716 | Train Acc: 0.8721 | Test Loss: 0.0186 | Test F1: 0.8088 | Test Acc: 0.8672
2026-01-30 19:46:36,664 - INFO - Validation loss decreased (inf --> 0.018609).  Saving model ...
2026-01-30 19:49:07,825 - INFO - Epoch: 02 | Train Loss: 0.0072 | Train F1: 0.9377 | Train Acc: 0.9379 | Test Loss: 0.0127 | Test F1: 0.8989 | Test Acc: 0.9271
2026-01-30 19:49:07,826 - INFO - Validation loss decreased (0.018609 --> 0.012747).  Saving model ...
2026-01-30 19:51:33,991 - INFO - Epoch: 03 | Train Loss: 0.0035 | Train F1: 0.9753 | Train Acc: 0.9749 | Test Loss: 0.0221 | Test F1: 0.8735 | Test Acc: 0.9062
2026-01-30 19:51:33,991 - INFO - EarlyStopping counter: 1 out of 3
2026-01-30 19:53:55,357 - INFO - Epoch: 04 | Train Loss: 0.0030 | Train F1: 0.9774 | Train Acc: 0.9771 | Test Loss: 0.0179 | Test F1: 0.8418 | Test Acc: 0.8646
2026-01-30 19:53:55,357 - INFO - EarlyStopping counter: 2 out of 3
2026-01-30 19:56:16,318 - INFO - Epoch: 05 | Train Loss: 0.0022 | Train F1: 0.9848 | Train Acc: 0.9847 | Test Loss: 0.0315 | Test F1: 0.8231 | Test Acc: 0.8724
2026-01-30 19:56:16,318 - INFO - EarlyStopping counter: 3 out of 3
2026-01-30 19:56:16,324 - INFO - Early stopping triggered. Stopping training.
2026-01-30 19:56:16,327 - INFO - Training process finished.
2026-01-30 19:56:16,327 - INFO - Generating final confusion matrix on the test set with the best model...
2026-01-30 19:56:26,247 - INFO - Confusion matrix saved to outputs\coat_lite_mini_20260130_185852/confusion_matrix_finetuned.png
2026-01-30 19:56:26,254 - INFO - Stage 2 (Fine-Tuning) complete.
2026-01-30 19:56:26,255 - INFO - Report saved to outputs\coat_lite_mini_20260130_185852\results_report_finetuned.pkl
2026-01-30 19:56:26,928 - INFO - Training curves plot saved to: outputs\coat_lite_mini_20260130_185852/training_curves_finetuned.png
2026-01-30 19:56:26,928 - INFO - All artifacts for the run are saved in: outputs\coat_lite_mini_20260130_193518
2026-01-30 19:56:26,928 - INFO - ==================================================
2026-01-30 19:56:26,928 - INFO - PIPELINE EXECUTION COMPLETE
2026-01-30 19:56:26,935 - INFO - Total duration: 21 minutes and 8 seconds.
2026-01-30 19:56:26,935 - INFO - ==================================================
