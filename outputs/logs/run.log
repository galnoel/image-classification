2025-10-28 14:02:56,865 - INFO - Configuration loaded and logging set up.
2025-10-28 14:02:56,865 - INFO - All outputs for this run will be saved in: outputs\efficientnet_b0_20251028_140256
2025-10-28 14:02:58,501 - INFO - Using device: cuda
2025-10-28 14:02:58,501 - INFO - Starting data preparation...
2025-10-28 14:02:58,570 - INFO - Using training data from: clean/train
2025-10-28 14:02:58,570 - INFO - Using validation data from: clean/test
2025-10-28 14:02:58,570 - INFO - Data preparation complete. Found classes: ['ba', 'ca', 'da', 'dha', 'ga', 'ha', 'ja', 'ka', 'la', 'ma', 'na', 'nga', 'nya', 'pa', 'ra', 'sa', 'ta', 'tha', 'wa', 'ya']
2025-10-28 14:02:58,570 - INFO - Initializing model: efficientnet_b0
2025-10-28 14:02:59,549 - INFO - Model 'efficientnet_b0' initialized and moved to 'cuda'.
2025-10-28 14:02:59,549 - INFO - Using CrossEntropyLoss.
2025-10-28 14:02:59,549 - INFO - Using AdamW optimizer with learning rate: 0.001
2025-10-28 14:02:59,549 - INFO - Loss function and optimizer initialized.
2025-10-28 14:02:59,549 - INFO - --- Starting Stage 1: Feature Extraction ---
2025-10-28 14:02:59,555 - INFO - Starting training for 10 epochs...
2025-10-28 14:07:42,903 - INFO - Epoch: 01 | Train Loss: 2.3115 | Train Acc: 0.2920 | Test Loss: 1.7793 | Test Acc: 0.4712
2025-10-28 14:07:43,063 - INFO - Model saved to outputs\efficientnet_b0_20251028_140256\best_model.pth
2025-10-28 14:07:43,065 - INFO - New best model saved to outputs\efficientnet_b0_20251028_140256/best_model.pth (Test Acc: 0.4712)
2025-10-28 14:08:26,994 - INFO - Epoch: 02 | Train Loss: 1.7913 | Train Acc: 0.4333 | Test Loss: 1.4767 | Test Acc: 0.5077
2025-10-28 14:08:27,049 - INFO - Model saved to outputs\efficientnet_b0_20251028_140256\best_model.pth
2025-10-28 14:08:27,049 - INFO - New best model saved to outputs\efficientnet_b0_20251028_140256/best_model.pth (Test Acc: 0.5077)
2025-10-28 14:09:09,770 - INFO - Epoch: 03 | Train Loss: 1.6243 | Train Acc: 0.4641 | Test Loss: 1.3501 | Test Acc: 0.5545
2025-10-28 14:09:09,818 - INFO - Model saved to outputs\efficientnet_b0_20251028_140256\best_model.pth
2025-10-28 14:09:09,819 - INFO - New best model saved to outputs\efficientnet_b0_20251028_140256/best_model.pth (Test Acc: 0.5545)
2025-10-28 14:09:52,056 - INFO - Epoch: 04 | Train Loss: 1.5466 | Train Acc: 0.4819 | Test Loss: 1.3715 | Test Acc: 0.5457
2025-10-28 14:10:34,262 - INFO - Epoch: 05 | Train Loss: 1.4881 | Train Acc: 0.5025 | Test Loss: 1.2825 | Test Acc: 0.5681
2025-10-28 14:10:34,322 - INFO - Model saved to outputs\efficientnet_b0_20251028_140256\best_model.pth
2025-10-28 14:10:34,332 - INFO - New best model saved to outputs\efficientnet_b0_20251028_140256/best_model.pth (Test Acc: 0.5681)
2025-10-28 14:11:16,107 - INFO - Epoch: 06 | Train Loss: 1.4739 | Train Acc: 0.4959 | Test Loss: 1.1650 | Test Acc: 0.6047
2025-10-28 14:11:16,169 - INFO - Model saved to outputs\efficientnet_b0_20251028_140256\best_model.pth
2025-10-28 14:11:16,169 - INFO - New best model saved to outputs\efficientnet_b0_20251028_140256/best_model.pth (Test Acc: 0.6047)
2025-10-28 14:11:58,466 - INFO - Epoch: 07 | Train Loss: 1.4340 | Train Acc: 0.5171 | Test Loss: 1.1557 | Test Acc: 0.5931
2025-10-28 14:12:41,002 - INFO - Epoch: 08 | Train Loss: 1.3925 | Train Acc: 0.5320 | Test Loss: 1.1163 | Test Acc: 0.6101
2025-10-28 14:12:41,049 - INFO - Model saved to outputs\efficientnet_b0_20251028_140256\best_model.pth
2025-10-28 14:12:41,049 - INFO - New best model saved to outputs\efficientnet_b0_20251028_140256/best_model.pth (Test Acc: 0.6101)
2025-10-28 14:13:23,138 - INFO - Epoch: 09 | Train Loss: 1.3733 | Train Acc: 0.5299 | Test Loss: 1.1168 | Test Acc: 0.6100
2025-10-28 14:14:05,200 - INFO - Epoch: 10 | Train Loss: 1.3600 | Train Acc: 0.5350 | Test Loss: 1.1405 | Test Acc: 0.6086
2025-10-28 14:14:05,200 - INFO - Training process finished.
2025-10-28 14:14:05,210 - INFO - Generating final confusion matrix on the test set with the best model...
2025-10-28 14:14:14,145 - INFO - Confusion matrix saved to outputs\efficientnet_b0_20251028_140256/confusion_matrix.png
2025-10-28 14:14:14,155 - INFO - Stage 1 (Feature Extraction) complete.
2025-10-28 14:14:14,155 - INFO - Report saved to outputs\efficientnet_b0_20251028_140256\results_report.pkl
2025-10-28 14:14:14,380 - INFO - Training curves plot saved to: outputs\efficientnet_b0_20251028_140256/training_curves.png
2025-10-28 14:14:14,380 - INFO - --- Starting Stage 2: Fine-Tuning ---
2025-10-28 14:14:14,484 - INFO - Loaded best model from Stage 1: outputs\efficientnet_b0_20251028_140256/best_model.pth
2025-10-28 14:14:14,484 - INFO - Unfroze the top layers of EfficientNet for fine-tuning.
2025-10-28 14:14:14,484 - INFO - Created new AdamW optimizer for fine-tuning with learning rate: 5e-05
2025-10-28 14:14:14,484 - INFO - Starting training for 15 epochs...
2025-10-28 14:15:03,461 - INFO - Epoch: 01 | Train Loss: 1.0505 | Train Acc: 0.6193 | Test Loss: 0.6746 | Test Acc: 0.7361
2025-10-28 14:15:03,505 - INFO - Model saved to outputs\efficientnet_b0_20251028_140256\best_model_finetuned.pth
2025-10-28 14:15:03,505 - INFO - New best model saved to outputs\efficientnet_b0_20251028_140256/best_model_finetuned.pth (Test Acc: 0.7361)
2025-10-28 14:15:51,905 - INFO - Epoch: 02 | Train Loss: 0.7219 | Train Acc: 0.7365 | Test Loss: 0.4986 | Test Acc: 0.7998
2025-10-28 14:15:51,954 - INFO - Model saved to outputs\efficientnet_b0_20251028_140256\best_model_finetuned.pth
2025-10-28 14:15:51,955 - INFO - New best model saved to outputs\efficientnet_b0_20251028_140256/best_model_finetuned.pth (Test Acc: 0.7998)
2025-10-28 14:16:39,960 - INFO - Epoch: 03 | Train Loss: 0.6069 | Train Acc: 0.7773 | Test Loss: 0.4107 | Test Acc: 0.8360
2025-10-28 14:16:40,014 - INFO - Model saved to outputs\efficientnet_b0_20251028_140256\best_model_finetuned.pth
2025-10-28 14:16:40,015 - INFO - New best model saved to outputs\efficientnet_b0_20251028_140256/best_model_finetuned.pth (Test Acc: 0.8360)
2025-10-28 14:17:28,013 - INFO - Epoch: 04 | Train Loss: 0.5070 | Train Acc: 0.8119 | Test Loss: 0.3555 | Test Acc: 0.8593
2025-10-28 14:17:28,071 - INFO - Model saved to outputs\efficientnet_b0_20251028_140256\best_model_finetuned.pth
2025-10-28 14:17:28,072 - INFO - New best model saved to outputs\efficientnet_b0_20251028_140256/best_model_finetuned.pth (Test Acc: 0.8593)
2025-10-28 14:18:16,137 - INFO - Epoch: 05 | Train Loss: 0.4415 | Train Acc: 0.8308 | Test Loss: 0.3206 | Test Acc: 0.8694
2025-10-28 14:18:16,190 - INFO - Model saved to outputs\efficientnet_b0_20251028_140256\best_model_finetuned.pth
2025-10-28 14:18:16,190 - INFO - New best model saved to outputs\efficientnet_b0_20251028_140256/best_model_finetuned.pth (Test Acc: 0.8694)
2025-10-28 14:19:06,221 - INFO - Epoch: 06 | Train Loss: 0.3946 | Train Acc: 0.8531 | Test Loss: 0.2871 | Test Acc: 0.8927
2025-10-28 14:19:06,285 - INFO - Model saved to outputs\efficientnet_b0_20251028_140256\best_model_finetuned.pth
2025-10-28 14:19:06,285 - INFO - New best model saved to outputs\efficientnet_b0_20251028_140256/best_model_finetuned.pth (Test Acc: 0.8927)
